# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура проекта

Проект организован по архитектурному паттерну MVP (Model - View - Presenter). Компоненты приложения разделены по слоям:

### Слои

#### components/models/
- `AppState.ts` — глобальное хранилище состояния приложения: товары, корзина, заказ, состояние загрузки и предпросмотра. Инкапсулирует в себе всю бизнес-логику модели, включая работу с корзиной, каталогом и заказом. Это позволяет избежать создания дополнительных моделей.
- `ApiModel.ts` — взаимодействие с сервером: получение каталога, оформление заказа.

#### components/views/
- `CardView.ts` — карточка товара.
- `BasketView.ts` — корзина товаров.
- `ContactsView.ts` — форма с контактными данными.
- `OrderView.ts` — форма выбора способа доставки и адреса.
- `SuccessView.ts` — страница подтверждения заказа.
- `ModalView.ts` — модальное окно.
- `FormView.ts` — общая логика валидации и отображения ошибок.
- `PageView.ts` — корневая вёрстка страницы.

#### components/base/
- `api.ts` — абстрактный базовый класс API.
- `events.ts` — реализация `EventEmitter`, используемого как брокер событий между слоями.

## Типы данных
Все типы описаны в `src/types/index.ts`. Включают:

### Продукты и карточки
- `IProduct` — товар из API
- `ICard` — карточка товара с дополнительными полями (`selected`, `button`)

### Корзина
- `IBasket` — отображение товаров в корзине и общая сумма

### Заказ и формы
- `IOrder` — финальный заказ
- `IOrderContacts`, `IOrderDeliveryForm` — части формы оформления
- `IOrderSuccess` — данные после оформления

### Приложение
- `IAppState` — глобальное состояние (каталог, корзина, заказ, предпросмотр и т.д.)
- `IPage` — состояние корневой страницы (отображаемые карточки и счётчик)

## Событийная архитектура

Во всех слоях используется единый брокер событий `EventEmitter`, реализованный в `src/components/base/events.ts`. Он позволяет:

- Подписываться на события (`on`)
- Снимать подписки (`off`)
- Генерировать события (`emit`)
- Глобально слушать события (`onAll`)

Взаимодействие между слоями View и Model осуществляется через события.

Перечисления событий оформлены как enum.